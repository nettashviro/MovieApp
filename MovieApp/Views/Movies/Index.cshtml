@using X.PagedList.Mvc.Core;
@model X.PagedList.IPagedList<MovieApp.Models.Movie>

@{
    ViewData["Title"] = "מאגר הסרטים";
}

<!-- CSS -->
<link type="text/css" href="~/css/moviesIndex.css?v=1.2.0" rel="stylesheet" asp-append-version="true">

@{ string userType = @Context.User.Claims.FirstOrDefault(c => c.Type == System.Security.Claims.ClaimTypes.Role)?.Value;}
<h1>מאגר הסרטים</h1>

<form asp-controller="Movies" asp-action="Index" method="get">
    <p>
        <div class="form-group row">
            <label class="col-sm-1 col-form-label col-form-label-sm">ז'אנר:</label>

            <div class="col-sm-5">
                <select asp-items="Html.GetEnumSelectList<Movie.MovieGenre>()" name="genreFilter" class="form-control form-control-sm">
                    <option value="">הכל</option>
                </select>
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-1 col-form-label col-form-label-sm">שם הסרט:</label>
            <div class="col-sm-5">
                <input type="text" name="nameFilter" class="form-control form-control-sm" />
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-1 col-form-label col-form-label-sm">שפה:</label>

            <div class="col-sm-5">
                <select asp-items="@(new SelectList(ViewBag.Languages, "Value", "Text"))" name="languageFilter" class="form-control form-control-sm">
                    <option value="">הכל</option>
                </select>
            </div>
        </div>
        <input type="submit" value="חפש סרט" class="btn btn-primary" />
    </p>
</form>

<div class="card shadow">
    <div class="container">
        <div class="row row-cols-4">
            @foreach (var item in Model)
            {
                <div class="col mb-4">
                    <div class="card h-100">
                        <div class="embed-responsive embed-responsive-1by1">
                            <img class="embed-responsive-item" src="@("/img/movies/"+ item.ImageUrl)">
                        </div>
                        <div class="card-body p-1">
                            <h2 class="card-title m-2">@Html.DisplayFor(modelItem => item.Name)</h2>
                            <p class="card-text m-2">@Html.DisplayFor(modelItem => item.Genre)</p>
                            <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-primary">Details</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
    <div class="pagination" style="margin-left: 400px">
        @Html.PagedListPager(Model, page => Url.Action("Index", new { page }))
    </div>
</div>

<p>
    <a class="btn btn-danger" asp-action="Create">צור חדש</a>
</p>

